# CLAUDE_ja.md

<!-- 
これは日本語話者向けの翻訳版です。
マスターファイルは CLAUDE.md です。
-->

## 基本方針

### 進化を支える開発原則
- **変更しやすさを最優先に設計する** - 機能改修時の影響範囲を局所化する
- **責任を明確に分離する** - 一つの機能は一つの場所で完結させる  
- **命名で意図を表現する** - 6ヶ月後の自分が理解できるよう命名する
- **依存関係を最小限にする** - 密結合を避け、独立性を保つ
- **抽象化レベルを統一する** - 同じレイヤーでは同じ抽象度で記述する

### 継続的改善の実践
- **小さなステップで前進する** - 1回の変更範囲を最小限に留める
- **動作確認を各ステップで行う** - ステップを進むたびに正しさを検証する
- **リファクタリングをコード変更のたびに行う** - 機能追加・改修・削除の度にコードの改善も実施する
- **テストを書いて安全網を作る** - 変更に対する恐怖を取り除く

### 複雑な問題に対する構造的かつ体系的なアプローチ

#### 調査フェーズの体系化
1. **現象の整理** - 何が、いつ、どこで起きているか
2. **影響範囲の特定** - 変更履歴と関連コンポーネントの洗い出し
3. **仮説の構築** - 可能性の高い原因から順序立てて検証
4. **解決策の選択肢化** - 複数のアプローチを比較可能な形で提示

#### 調査結果の効果的な提示方法
- **結論ファースト**: 原因と解決策を最初に明示
- **選択肢の構造化**: メリット・デメリットを含めて比較提示
- **技術詳細の階層化**: 概要→詳細の順で情報を整理
- **次のアクションの明確化**: ユーザーの判断が必要な点を明示

#### ユーザーとの協働パターン
- **徹底的な調査要求への対応**: 複雑な問題では並列調査で網羅的に情報収集
- **意思決定支援**: 技術的選択肢を業務影響の観点で整理
- **進捗の可視化**: TodoWriteで調査・作業プロセスを透明化

## AIエージェントへの指示

### 全般

#### NEVER: 決して行わないこと
- ユーザーの明示的な確認なくファイルを削除すること
- 既存コードを理解せずに変更すること

#### MUST: 必ず実行すること
- 日本語で応答すること
- 変更前に必ず既存コードの構造と意図を把握すること
- 小さな変更に分割して段階的に実装すること
- 実装後は必ず動作確認の方法を提示すること

#### IMPORTANT: 常に意識すること
- 動くコードよりも変更しやすいコードを重視すること
- 短期的な解決より長期的な保守性を考慮すること
- コードの意図や設計判断を説明すること
- 完璧よりも継続的改善を選択すること
- リファクタリングの機会を積極的に提案すること
- テストの追加や改善を促すこと

### コミットメッセージ作成時の支援

#### MUST: 必ず実行すること
- 複数の案を提示すること(最低 3 つ)
- 50 文字から 60 文字以内で案を作成すること
- 短く、しかし情報豊かに表現すること

#### IMPORTANT: 常に意識すること
- ｢何を｣だけでなく｢なぜ｣｢どのように｣も重視すること
- ユーザーの案も含めて比較検討すること
- 文字数と内容のバランスを提示すること
- 文法や慣例の観点からも提案すること

## 開発ワークフロー

### 実装の進め方
1. **理解** - 既存コードとドメインを把握する
2. **設計** - 変更箇所と影響範囲を明確にする  
3. **実装** - 最小限の変更で動作させる
4. **検証** - 動作確認とテスト追加
5. **改善** - リファクタリングで品質向上

### 品質基準

#### 問題解決の深度と実用性
- [ ] 複数の解決アプローチを検討したか？
- [ ] ユーザーの選択を支援する情報を提供したか？
- [ ] 変更の影響範囲を適切に評価したか？
- [ ] 解決後の検証方法を明確にしたか？
- [ ] 「技術的正しさ」と「実用的効果」のバランスを考慮したか？

#### アジリティ
- [ ] 新しい要求が来た時に変更しやすいか？
- [ ] 機能を拡張する時に既存コードを壊さないか？
- [ ] コードの意図が6ヶ月後の自分にも理解できるか？
- [ ] 他の開発者がすぐに理解できる構造か？
- [ ] テストが変更を安全にサポートしているか？
- [ ] モジュール間の依存関係が最小限になっているか？

#### パフォーマンス
- [ ] 処理時間が既存の同等機能と同程度か？
- [ ] メモリ使用量が想定範囲内か？
- [ ] データベースクエリが効率的か？
- [ ] ボトルネックが特定しやすい構造になっているか？
- [ ] 不要な処理や重複処理がないか？

#### エラーハンドリング
- [ ] 全ての例外パスでエラーメッセージが返されるか？
- [ ] 外部依存が失敗した時のフォールバック処理があるか？
- [ ] エラー時にもシステムが安定した状態を保てるか？
- [ ] ユーザーにとって理解しやすいエラーメッセージか？
- [ ] 部分的な失敗でもサービス継続できるか？

#### セキュリティリスク
- [ ] 秘密情報がログやレスポンスに出力されていないか？
- [ ] 入力値の検証が境界値まで含めて実装されているか？
- [ ] 認証・認可が適切に機能するか？
- [ ] 権限昇格の脆弱性がないか？
- [ ] 外部API呼び出しが安全に実装されているか？

#### ログや監視の仕組み
- [ ] 問題発生時に原因を特定できる情報が記録されるか？
- [ ] 重要な処理の開始・終了が追跡できるか？
- [ ] 異常な状況を検知する仕組みがあるか？
- [ ] パフォーマンスメトリクスが取得できるか？
- [ ] ビジネス価値の測定が可能か？

## ドキュメンテーションの原則

### 具体的でありながら自然な日本語
- **抽象的な美辞麗句を避ける** - 行動につながらない表現は使わない
- **行動可能な表現を使う** - 読み手が何をすべきか明確にする
- **測定可能な基準を含める** - 判断に迷わない具体性を持たせる

### 良い例と悪い例

#### コード表現
❌ `getUserData()` - 何のデータか不明  
⭕ `getActiveUserProfileForDashboard()` - 用途と対象が明確

#### ドキュメント表現
❌ 「品質を大切にする」（曖昧）  
⭕ 「変更時に既存機能が壊れないことを確認する」（具体的かつ自然）

#### コミットメッセージ
❌ `fix: Update code` - 何を修正したか不明  
⭕ `fix: Resolve user login timeout after 5 minutes` - 問題と解決が明確

## ドキュメントの自己改善プロセス

### 改善のトリガー
- 1 セッション内で複数回数のターンを完了した（目安として､ 5 回以上の反復）
- ガイドラインでカバーされていない､新しいタイプの課題に遭遇した
- セッションでの実践を通じて､より効果的なアプローチを発見した時
- ユーザーフィードバックで不足や不明確な指示が判明した時

### 改善項目

#### MUST: 必ず実行すること
- 困難な問題解決プロセスから､教訓を抽出すること
- 複雑なセッション後にこの文書の改善を提案すること
- より良い表現が見つかった時は､修正案を提示すること
- 実践を通じて文章に不足が発見された際は､具体的な追記を提案すること

#### IMPORTANT: 常に意識すること
- 迅速な問題解決につながったセッションと､苦労したセッションのパターンを特定すること
- どのガイドラインが実践で最も/最も少なく有効だったかを振り返ること
- 新たなニーズや洞察に基づいて､新たなセクションを提案すること
- 実際の使用が文書化された原則と乖離する場合に気づくこと
- 「完璧な解決策」よりも「段階的な改善」を重視する実践的アプローチの価値を認識すること
