# CLAUDE.md

## 基本方針

### 進化を支える開発原則
- **変更しやすさを最優先に設計する** - 将来の変更を妨げない構造を作る
- **責任を明確に分離する** - 一つの機能は一つの場所で完結させる  
- **依存関係を最小限にする** - 密結合を避け、独立性を保つ
- **抽象化レベルを統一する** - 同じレイヤーでは同じ抽象度で記述する
- **命名で意図を表現する** - コードが自己説明的になるよう丁寧に命名する

### 継続的改善の実践
- **小さなステップで前進する** - 一度に変更する範囲を最小限に留める
- **動作確認を頻繁に行う** - 各ステップで必ず検証する
- **リファクタリングを日常的に行う** - 機能追加の度にコードの改善も実施する
- **テストを書いて安全網を作る** - 変更に対する恐怖を取り除く

## 開発ワークフロー

### 実装の進め方
1. **理解** - 既存コードとドメインを把握する
2. **設計** - 変更箇所と影響範囲を明確にする  
3. **実装** - 最小限の変更で動作させる
4. **検証** - 動作確認とテスト追加
5. **改善** - リファクタリングで品質向上

### 品質チェックポイント

#### アジリティ
- [ ] 新しい要求が来た時に変更しやすいか？
- [ ] 機能を拡張する時に既存コードを壊さないか？
- [ ] コードの意図が6ヶ月後の自分にも理解できるか？
- [ ] 他の開発者がすぐに理解できる構造か？
- [ ] テストが変更を安全にサポートしているか？
- [ ] モジュール間の依存関係が最小限になっているか？

#### パフォーマンス
- [ ] 処理時間が既存の同等機能と同程度か？
- [ ] メモリ使用量が想定範囲内か？
- [ ] データベースクエリが効率的か？
- [ ] ボトルネックが特定しやすい構造になっているか？
- [ ] 不要な処理や重複処理がないか？

#### エラーハンドリング
- [ ] 全ての例外パスでエラーメッセージが返されるか？
- [ ] 外部依存が失敗した時のフォールバック処理があるか？
- [ ] エラー時にもシステムが安定した状態を保てるか？
- [ ] ユーザーにとって理解しやすいエラーメッセージか？
- [ ] 部分的な失敗でもサービス継続できるか？

#### セキュリティリスク
- [ ] 秘密情報がログやレスポンスに出力されていないか？
- [ ] 入力値の検証が境界値まで含めて実装されているか？
- [ ] 認証・認可が適切に機能するか？
- [ ] 権限昇格の脆弱性がないか？
- [ ] 外部API呼び出しが安全に実装されているか？

#### ログや監視の仕組み
- [ ] 問題発生時に原因を特定できる情報が記録されるか？
- [ ] 重要な処理の開始・終了が追跡できるか？
- [ ] 異常な状況を検知する仕組みがあるか？
- [ ] パフォーマンスメトリクスが取得できるか？
- [ ] ビジネス価値の測定が可能か？

## Claude Code への指示

### NEVER（絶対禁止）
- ファイルの削除を行うこと
- git commit や git push の実行
- 既存コードを理解せずに変更すること

### YOU MUST（必須事項）
- 日本語で応答すること
- 変更前に必ず既存コードの構造と意図を把握すること
- 実装後は必ず動作確認の方法を提示すること
- 小さな変更に分割して段階的に実装すること

### IMPORTANT（重要事項）
- 動くコードよりも変更しやすいコードを重視すること
- 短期的な解決より長期的な保守性を考慮すること
- リファクタリングの機会を積極的に提案すること
- テストの追加や改善を促すこと
- コードの意図や設計判断を説明すること
- 完璧よりも継続的改善を選択すること
